<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TecnoNewsUY - Inicio</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
</head>
<body>
    <header>
        <h1 class="titulo-principal">TecnoNewsUY</h1>
        <nav class="menu">
            <a href="index.html">Inicio</a>
            <a href="page1.html">Noticias</a>
            <a href="page2.html">Última Hora</a>
            <a href="page3.html">Ofertas</a>
        </nav>
    </header>
    
    <div class="container">
        <h2 class="section-title">Últimas noticias</h2>

        <section id="noticias-lista" class="noticias-lista">
            <!-- Aquí se mostrarán las últimas 3 noticias -->
        </section>
    </div>
    
    <script src="script.js"></script>
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        const noticiasLista = document.getElementById('noticias-lista');

        if (!noticiasLista) {
          console.error("Error: No se encontró el elemento con el ID 'noticias-lista'");
          return;
        }

        // Obtener las noticias desde el archivo JSON
        fetch('https://raw.githubusercontent.com/TecnoNewsUY/TecnoNewsUY/master/todaslasnoticias/todaslasnoticias.json')
          .then(response => response.json())
          .then(data => {
            // Filtrar las noticias por categoría y eliminar duplicados
            const noticiasPorCategoria = {};

            data.forEach(noticia => {
              const categoria = noticia.categoria;
              if (!noticiasPorCategoria.hasOwnProperty(categoria)) {
                noticiasPorCategoria[categoria] = [];
              }
              if (!noticiasPorCategoria[categoria].some(n => n.titulo === noticia.titulo)) {
                noticiasPorCategoria[categoria].push(noticia);
              }
            });

            // Obtener las últimas 3 noticias
            const ultimasNoticias = [];
            for (let categoria in noticiasPorCategoria) {
              const noticiasCategoria = noticiasPorCategoria[categoria];
              if (noticiasCategoria.length > 0) {
                ultimasNoticias.push(noticiasCategoria[noticiasCategoria.length - 1]);
              }
            }

            // Ordenar las últimas noticias por fecha descendente
            ultimasNoticias.sort((a, b) => new Date(b.fecha) - new Date(a.fecha));

            // Mostrar las últimas noticias en la página index.html
            ultimasNoticias.slice(0, 3).forEach(noticia => {
              const divNoticia = document.createElement('div');
              divNoticia.classList.add('noticia');

              const titulo = document.createElement('h3');
              titulo.textContent = noticia.titulo;

              const contenido = document.createElement('p');
              contenido.textContent = noticia.contenido;

              const imagen = document.createElement('img');
              imagen.src = noticia.imagen;
              imagen.alt = noticia.titulo;

              divNoticia.appendChild(titulo);
              divNoticia.appendChild(contenido);
              divNoticia.appendChild(imagen);

              noticiasLista.appendChild(divNoticia);
            });
          })
          .catch(error => console.log(error));
      });
    </script>
</body>
</html>
